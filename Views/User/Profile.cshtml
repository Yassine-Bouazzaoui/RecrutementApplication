@model RecrutementApplication.Models.ApplicationUser
@using Microsoft.AspNetCore.Identity
@using System.Security.Claims

@{
    ViewData["Title"] = "Profil utilisateur avancé";
    var userManager = Context.RequestServices.GetService<UserManager<ApplicationUser>>();
    var userRoles = userManager.GetRolesAsync(Model).Result;
    var isCandidat = userRoles.Contains("Candidat");
    var isRecruteur = userRoles.Contains("Recruteur");
}

<div class="container mt-5">
    <!-- Bannière -->
    <div class="profile-banner" style="background: url('/img/banner.jpg') no-repeat center center; background-size: cover; height: 200px; position: relative; border-radius: 8px;">
        <div class="profile-picture" style="position: absolute; bottom: -50px; left: 20px;">
            <img src="@Url.Content("~/img/profile-placeholder.png")" alt="Photo de profil" class="rounded-circle border border-white" style="width: 100px; height: 100px; object-fit: cover;" />
        </div>
    </div>

    <!-- Informations principales -->
    <div class="text-center mt-5">
        <h2>@Model.Nom @Model.Prenom</h2>
        <p class="text-muted">@Model.Mail | @Model.PhoneNumber</p>
        @if (isCandidat)
        {
            <span class="badge bg-success"><i class="fas fa-user-graduate"></i> Candidat</span>
        }
        @if (isRecruteur)
        {
            <span class="badge bg-info"><i class="fas fa-briefcase"></i> Recruteur</span>
        }
    </div>

    <!-- Résumé -->
    <div class="card mt-4 shadow-sm">
        <div class="card-body">
            <h5><i class="fas fa-info-circle me-2"></i> À propos</h5>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer non eros at elit imperdiet convallis.</p>
        </div>
    </div>

    <!-- Informations spécifiques -->
    <div class="mt-4">
        @if (isCandidat)
        {
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <h5><i class="fas fa-user-graduate me-2"></i> Informations du candidat</h5>
                    <p><strong>Titre:</strong> @Model.Titre</p>
                    <p><strong>Diplôme:</strong> @Model.Diplome</p>
                    <p><strong>Profil:</strong> @Model.Profil</p>
                    <p><strong>Années d'expérience:</strong> @Model.NbAnsExp</p>
                    <p><strong>CV:</strong> <a href="@Model.CV" target="_blank">Télécharger le CV</a></p>
                </div>
            </div>
        }
        @if (isRecruteur)
        {
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <h5><i class="fas fa-building me-2"></i> Informations de l'entreprise</h5>
                    <p><strong>Entreprise:</strong> @Model.Entreprise</p>
                    @if (!string.IsNullOrEmpty(Model.EntrepriseLogo))
                    {
                        <img src="@Url.Content($"~/img/{Model.EntrepriseLogo}")" alt="Logo" class="rounded" style="width: 100px; object-fit: contain;" />
                    }
                    else
                    {
                        <p>Aucun logo disponible</p>
                    }
                </div>
            </div>
        }
    </div>

    <!-- Bouton d'édition -->
    <div class="text-center mt-4">
        <a href="/Account/EditProfile" class="btn btn-warning"><i class="fas fa-edit"></i> Modifier le profil</a>
    </div>
</div>
<style>
    .profile-banner {
        position: relative;
        border-radius: 8px;
        overflow: hidden;
    }

    .profile-picture img {
        border: 5px solid white;
    }

</style>